import socket

from IPy import IP

class PortScan():
    banner = []
    open_ports = []
    def __init__(self, target, num_ports):
        self.target = target
        self.num_ports = num_ports

    def scan(self):

        for port in range(1,65335):

            self.scan_port(port)


    def check_ip(self):

        try:

            IP(self.target)

            return (self.target)

        except ValueError:

            return socket.gethostbyname(self.target)

    def scan_port(self, port):

        try:
            converted_ip = self.check_ip()
            sock = socket.socket()

            sock.settimeout(0.5)

            sock.connect((converted_ip, port))
            self.open_ports.append(port)

            try:
                banner = sock.recv(1024).decode().strip('/n').strip('/r')
                self.banners.append(banner)
            except:
                self.banners.append(' ') 
            
            sock.close()
        except:
            pass





if __name__ == "__main__":
    targets = input('[+] Enter Target/s To Scan(split multiple targets with a comma)')
    num_ports = input('[+] Enter Number Of Ports To Scan')
    if ',' in targets:
        for ip_address in targets.split(','):
            scanner = PortScan(ip_address.strip(' '), num_ports)
            scanner.scan()

    else:
        scanner = PortScan(targets, num_ports)
        scanner.scan(targets)




